{% extends "base.html" %}

{% set is_edit = status is not none %}

{% block title %}AutoKanban — Статусы{% endblock %}

{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h3 mb-0">{{ "Редактировать" if is_edit else "Новый статус" }}</h1>
    <a class="btn btn-outline-secondary" href="{{ url_for('roles.list_statuses') }}">Назад</a>
  </div>

  <div class="card shadow-sm">
    <div class="card-body">
      <form method="post" action="{{ url_for('roles.update_status', status_id=status.id) if is_edit else url_for('roles.create_status') }}">
        <div class="mb-3">
          <label class="form-label" for="name">Имя</label>
          <input
            class="form-control"
            id="name"
            name="name"
            type="text"
            value="{% if name is defined %}{{ name }}{% elif status %}{{ status.name }}{% else %}{{ "" }}{% endif %}"
            required
          >
        </div>
        <div class="mb-3">
          <label class="form-label" for="board_id">Доска</label>
          <select class="form-select" id="board_id" name="board_id" required>
            <option value="">Выберите доску</option>
            {% for board in boards %}
              {% set selected = (board_id is defined and board_id and board_id|int == board.id) or (status and board.id == status.board_id) %}
              <option value="{{ board.id }}" {% if selected %}selected{% endif %}>{{ board.name }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="mb-3">
          <label class="form-label" for="position">Позиция</label>
          <input
            class="form-control"
            id="position"
            name="position"
            type="number"
            value="{% if position is defined %}{{ position }}{% elif status %}{{ status.position }}{% else %}{{ "" }}{% endif %}"
            required
          >
        </div>
        <div class="mb-3">
          <label class="form-label" for="color">Цвет</label>
          <input
            class="form-control form-control-color"
            id="color"
            name="color"
            type="color"
            value="{% if color is defined %}{{ color }}{% elif status %}{{ status.color }}{% else %}{{ "#0d6efd" }}{% endif %}"
            required
          >
        </div>
        <button class="btn btn-primary" type="submit">Сохранить</button>
      </form>
    </div>
  </div>
{% endblock %}
